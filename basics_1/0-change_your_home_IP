#!/usr/bin/env bash
# Script that changes localhost to resolve to 127.0.0.2 and facebook.com to 8.8.8.8

# Must be run as root
if [[ $EUID -ne 0 ]]; then
  echo "Please run as root (use sudo)" >&2
  exit 1
fi

# Backup /etc/hosts if not already backed up
[ ! -f /etc/hosts.bak ] && cp /etc/hosts /etc/hosts.bak

# Create a temp file
temp_file=$(mktemp)

# Copy all lines except those containing localhost or facebook.com
grep -vE '\s+localhost|facebook\.com' /etc/hosts > "$temp_file"

# Append the required entries
echo "127.0.0.2 localhost" >> "$temp_file"
echo "8.8.8.8 facebook.com" >> "$temp_file"

# Overwrite the /etc/hosts file
cp "$temp_file" /etc/hosts

# Clean up
rm "$temp_file"

